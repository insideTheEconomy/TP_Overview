function WAMP(e){var t;self=this;self.callbacks=e.wampMethods;try{t=require("autobahn")}catch(n){console.log(n)}var r,i=new t.Connection({url:url,realm:"tradingpit"});i.onopen=function(e){self.sess=e;var t=null;e.subscribe("pit.pub.phase",self.callbacks.onPhase).then(function(e){t=e},function(e){});e.subscribe("pit.pub.players",self.callbacks.storePlayers).then(function(e){t=e},function(e){});e.subscribe("pit.pub.clock",self.callbacks.onTick).then(function(e){t=e},function(e){});e.subscribe("pit.pub.round",storeRound).then(function(e){console.log("Round Subscription Successfull!",e);t=e},function(e){});e.subscribe("pit.pub.transaction",function(e,t){console.log("TRANSACTION: ",t);trans&&trans.push(t)});e.call("pit.rpc.getPhase",[],{}).then(function(e){console.log("SharedScreen Get Phase: ",e)})};i.open()}function storeRound(e,t,n){console.log("storeRound(), roundData: ",t);roundData=t}function storePlayers(e,t,n){curPlayers=t}var sharedscreenwamp=function(){this.wampMethods={test:function(){alert("I'm the shared screen!")},onTick:function(e,t,n){$("#time").html(t.end_of_phase.minutes+":"+t.end_of_phase.seconds)},rpcCall:function(e){},onPhase:function(e,t,n){console.log("onPhase: ",t);if(t.action=="enter")switch(t.name){case"Setup":phase=0;loadScreen("shared_2.html",function(){$("#eorTrans").empty();pChart=new playerChart("#eorTrans",875,705);pChart.draw(roundData.players);pChart.drawWinner("#winner")});break;case"Round":phase=1;loadScreen("shared_1.html",function(){$("#trans").empty();trans=new transactionChart("#trans",875,645);$("#eqprice").html(trans.eq_price);$("#status").empty();pChart=new playerStatusChart("#status",830,390)});break;case"Wrap-up":phase=2;loadScreen("shared_2.html",function(){$("#eorTrans").empty();pChart=new playerChart("#eorTrans",875,705);pChart.draw(roundData.players);pChart.drawWinner("#winner")});break;case"Player Recap":phase=3;loadScreen("shared_0.html",function(){$("#dist").empty();dist=new distChart("#dist",875,840);dist.draw(roundData.transactions.distribution)});break;case"World News":loadScreen("shared_news.html",function(){})}else switch(t.name){case"Setup":pChart=null;break;case"Round":trans=null;break;case"Wrap-up":dist=null;break;case"Player Recap":pChart=null}}};this.wamp=new WAMP(this)};w=new sharedscreenwamp;var curPlayers;